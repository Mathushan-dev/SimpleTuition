{% extends 'base.html' %}

{% block title %}Admin Assignments{% endblock %}

{% block content %}
<div class="dashboard">
  <header class="dash-head">
    <h1>Assignments</h1>
    <p class="muted">Students assigned to subjects and per-student pricing</p>
  </header>

  {% include 'admin_nav.html' %}

  <section class="admin-list">
    <h2>Assignments</h2>
    <div class="search-row">
      <input type="search" id="assign-search" placeholder="Filter by subject id or student id">
      <div class="chip">{{ assignments|length }}</div>
    </div>
    <div class="list" id="assignments-list">
      {% if assignments %}
        {% for a in assignments %}
          <div class="list-item card" data-subject="{{ a.subject_id }}" data-student="{{ a.student_name or a.student_id }}">
            <div style="flex:1">
              <h3 style="margin:0">Subject {{ a.subject_id }} <small class="muted">{{ a.student_name or ('Student ' ~ a.student_id) }}</small></h3>
              <p class="muted" style="margin:6px 0">{% if a.get('price') %}Price: £{{ a.price }}{% else %}Price: (not set){% endif %}</p>
              <div class="details">
                <p class="muted" style="margin:6px 0">Subject ID: {{ a.subject_id }} · Student ID: {{ a.student_id }}</p>
              </div>
            </div>
            <div class="actions">
              <a class="btn small" href="/admin/edit_assignment?subject_id={{ a.subject_id }}&student_id={{ a.student_id }}" title="Edit assignment">✏️</a>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <div class="muted">No assignments yet.</div>
      {% endif %}
    </div>

    <h3 style="margin-top:12px">Assign Student to Subject</h3>
    <form method="post" action="/admin/subjects/assign" class="form-row">
      <label>Subject ID <input name="subject_id" type="number" required></label>
      <label>Student ID <input name="student_id" type="number" required></label>
      <label>Price (optional) <input name="price" type="number" step="0.01"></label>
      <button class="btn primary">Assign</button>
    </form>
  </section>

</div>
{% endblock %}
