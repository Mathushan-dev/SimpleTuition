{% extends 'base.html' %}
{% block title %}Admin Reports{% endblock %}
{% block content %}
<div class="page-title">
  <h1>Reports</h1>
  <div class="muted">High-level overview for admins</div>
</div>

{% include 'admin_nav.html' %}

<section class="section info-list">
  <div class="info-item">
    <h3>Users</h3>
    <p class="muted">Students: {{ user_counts.students }}</p>
    <p class="muted">Tutors: {{ user_counts.tutors }}</p>
    <p class="muted">Admins: {{ user_counts.admins }}</p>
  </div>
  <div class="info-item">
    <h3>Bookings</h3>
    <p class="muted">Confirmed: {{ booking_counts.confirmed }}</p>
    <p class="muted">Pending: {{ booking_counts.pending }}</p>
    <p class="muted">Attended: {{ booking_counts.attended }}</p>
    <p class="muted">Absent: {{ booking_counts.absent }}</p>
    <p class="muted">Cancelled: {{ booking_counts.cancelled }}</p>
  </div>
  <div class="info-item">
    <h3>Payouts</h3>
    <p class="muted">Total payouts recorded: Â£{{ '%.2f'|format(total_payouts) }}</p>
  </div>
</section>

<section class="section">
  <h2>Upcoming Lessons</h2>
  {% if upcoming %}
    <table class="table">
      <thead>
        <tr><th>ID</th><th>Student</th><th>Tutor</th><th>Subject</th><th>Date / Time</th><th>Status</th></tr>
      </thead>
      <tbody>
      {% for b in upcoming %}
        <tr>
          <td>{{ b.booking_id }}</td>
          <td>{{ b.student_id }}</td>
          <td>{{ b.teacher_id }}</td>
          <td>{{ b.subject_id }}</td>
          <td>{{ b.date_time }}</td>
          <td>{{ b.status }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="muted">No upcoming lessons found.</p>
  {% endif %}
</section>

<section class="section">
  <h2>Subjects</h2>
  {% if subjects %}
    <div class="subject-grid">
      {% for s in subjects %}
        <div class="subject-card">
          <h3>{{ s.name }}</h3>
          <p class="muted">{{ s.description }}</p>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="muted">No subjects available yet. Seed sample subjects from Admin Subjects.</p>
  {% endif %}
</section>
{% endblock %}
